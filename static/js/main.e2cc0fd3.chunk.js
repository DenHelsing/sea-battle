(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,n){e.exports=n(39)},27:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),o=n.n(i),c=(n(27),n(4)),l=n(8),s=(n(32),n(33),n(3)),p=n(17),u=n(18),h=n(20),f=n(19),m=n(21),d=n(10),g=(n(35),n(36),n(37),{BATTLESHIP:"battleship-4",CRUISER:"cruiser-3",DESTROYER:"destroyer-2",PATROL_BOAT:"patrul_boat-1"}),v=function(e){if("string"===typeof e)return Number(e.substr(e.indexOf("-")+1,1))},y=function(e){if("string"===typeof e)return e.substring(0,e.indexOf("-"))},S=function(e,t,n){for(var a=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],r=0;r<a.length;r++){var i=a[r];if(void 0!==n[e+i[0]]&&void 0!==n[e+i[0]][t+i[1]]&&!0===n[e+i[0]][t+i[1]].isShip)return!0}return!1},E=function(e){if("string"===typeof e){var t=e.split("-"),n=Object(s.a)(t,2),a=n[0],r=n[1];return[Number(a),Number(r)]}},O=n(9),b=(n(38),r.a.memo(function(e){var t=e.color,n=e.coord,a=e.shipLength,i=10-n[1]-a,o={opacity:.5,position:"absolute",top:0,left:30*i,backgroundColor:t,width:"".concat(30*a,"px"),height:"100%",zIndex:10};return i<0?r.a.createElement("div",{style:o}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:Object(O.a)({},o,{left:0,width:"30px"})}),r.a.createElement(T,{color:t,shipLength:a}))})),T=function(e){var t=e.color,n=e.shipLength,a=Object(c.e)({accept:[g.BATTLESHIP,g.CRUISER,g.DESTROYER,g.PATROL_BOAT],collect:function(e){return{isOver:e.isOver()}}}),i=Object(s.a)(a,2),o=i[0].isOver,l=i[1],p={opacity:.5,position:"absolute",top:0,backgroundColor:t,left:30,width:"".concat(30*(n-1),"px"),height:"100%",zIndex:10};return o?null:r.a.createElement("div",{ref:l,style:p})},D=b,C=function(e){var t=e.onClick,n=e.value,a=e.cellData,i=e.canDropShip,o=e.placeShip,l=a.isShot,p=a.isShip,u=a.id,h=a.player,f=p&&l,m=!p&&l,d=Object(c.e)({accept:[g.BATTLESHIP,g.CRUISER,g.DESTROYER,g.PATROL_BOAT],canDrop:function(){return i(u,h,T)},drop:function(){o(u,h,T)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop(),itemType:e.getItemType()}}}),y=Object(s.a)(d,2),S=y[0],O=S.isOver,b=S.canDrop,T=S.itemType,C=y[1];return r.a.createElement("div",{ref:C,className:"cell\n                            ".concat(n?"not-clickable":"clickable"," \n                            ").concat(f?"hit":""," \n                            ").concat(m?"blank":"","\n                            ").concat(p?"ship":""),onClick:function(){t(u,p,h)}},n,!n&&O&&r.a.createElement(D,{color:"".concat(b?"orange":"red"),coord:E(u),shipLength:v(T)}))},k=function(){};C.defaultProps={onClick:k,value:!1,cellData:{isShip:!1,isShot:!1,player:-1,id:-1},canDropShip:k,placeShip:k};var j=r.a.memo(C),w=function(e,t,n,a){if(e.length>1){for(var i=[],o=[],c=0;c<11;c++){i[c]=0===c?[null]:[r.a.createElement(j,{value:c})];for(var l=1;l<11;l++)i[c][l]=0===c?r.a.createElement(j,{value:l}):r.a.createElement(j,{cellData:e[c-1][l-1],onClick:a,canDropShip:t,placeShip:n});o[c]=r.a.createElement("div",{className:"row"},i[c])}return r.a.createElement("div",{className:"battlefield"},o)}return r.a.createElement("h1",null,"ZHOPA")},R=function(){},x=r.a.memo(function(e){var t=e.shipsData,n=e.shotsData,a=e.endturn,i=e.label,o=e.onCellClick,c=e.className,l=e.canDropShip,s=e.placeShip,p=w(t,l,s),u=w(n,R,R,o);return r.a.createElement("div",{className:"gamefield ".concat(c)},r.a.createElement("h1",null,i),r.a.createElement("div",null,r.a.createElement("h1",null,"Opponent's Field"),u),r.a.createElement("button",{className:"endturn",onClick:a},"End Turn"),r.a.createElement("div",null,r.a.createElement("h1",null,"Your Field"),p))}),A=function(e){var t=e.shipType,n=e.children,i=Object(c.c)({item:{type:g[t]},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(s.a)(i,3),p=(o[0].isDragging,o[1]),u=o[2];return Object(a.useEffect)(function(){u(Object(l.b)(),{captureDraggingState:!0})}),r.a.createElement("div",{ref:p},n)},I={isShip:!0,isShot:!1,player:-1,id:-1},P=function(e){for(var t=[],n=0;n<e;n++)t[n]=r.a.createElement(j,{value:!0,cellData:I});var a="";return 1===e&&(a="PATROL_BOAT"),2===e&&(a="DESTROYER"),3===e&&(a="CRUISER"),4===e&&(a="BATTLESHIP"),r.a.createElement(A,{shipType:a},r.a.createElement("div",{style:L},t))},L={display:"flex",flexDirection:"row"},N=P(4),Y=P(3),B=P(2),M=P(1),_={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},H="http://127.0.0.1:8080/",F=function(e,t,n,a){return e&&t?{left:n.x,top:n.y-15}:{display:"none"}},U=r.a.memo(function(){var e=Object(c.d)(function(e){return{clientOffset:e.getClientOffset(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}}),t=e.itemType,n=e.isDragging,a=e.clientOffset,i=e.initialOffset,o=e.currentOffset;return n?r.a.createElement("div",{style:_},r.a.createElement("div",{style:Object(O.a)({position:"absolute"},F(i,o,a))},function(){var e=y(t),n=v(t);return r.a.createElement("img",{src:"".concat(H).concat(e,".png"),alt:"ship_preview",style:{width:"".concat(30*n,"px")}})}())):null}),z=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isYourTurn:!0,player1ships:"1",player1shots:"1",player2ships:"1",player2shots:"1",varToChange:1},n.plusOne=function(){n.setState(function(e){return{varToChange:e.varToChange+1}})},n.endTurn=function(){n.setState(function(e){return{isYourTurn:!e.isYourTurn}})},n.generateCellsData=function(){for(var e=[],t=[],a=[],r=[],i=0;i<10;i++){e[i]=[],t[i]=[],a[i]=[],r[i]=[];for(var o=0;o<10;o++)e[i][o]={isShip:!1,isShot:!1,player:1,id:"".concat(i,"-").concat(o)},t[i][o]={isShip:!1,isShot:!1,player:1,id:"".concat(i,"-").concat(o)},a[i][o]={isShip:!1,isShot:!1,player:2,id:"".concat(i,"-").concat(o)},r[i][o]={isShip:!1,isShot:!1,player:2,id:"".concat(i,"-").concat(o)}}n.setState({player1ships:e,player1shots:t,player2ships:a,player2shots:r})},n.canDropShip=function(e,t,a){var r=E(e),i=Object(s.a)(r,2),o=i[0],c=i[1],l=v(a),p=n.state,u=p.player1ships,h=p.player2ships,f=t-1?h:u;if(c<=f[o].length-l){for(var m=0;m<l;m++)if(!0===f[o][c+m].isShip)return console.log("Ship is under"),!1;for(var d=0;d<l;d++)if(S(o,c+d,f))return console.log("Ship is around"),!1;return!0}for(var g=10-c-l,y=g;y<l+g;y++)if(!0===f[o][c+y].isShip)return!1;for(var O=g;O<l+g;O++)if(S(o,c+O,f))return!1;return!0},n.placeShip=function(e,t,a){var r=E(e),i=Object(s.a)(r,2),o=i[0],c=i[1],l=v(a),p=n.state,u=p.player1ships,h=p.player2ships,f=t-1?"player2ships":"player1ships";c<=(t-1?h:u)[o].length-l?(console.log("Trying to place deeper"),n.setState(Object(d.a)(function(e){for(var t=0;t<l;t++)e[f][o][c+t].isShip=!0}))):(console.log("Trying to place in proh"),n.setState(Object(d.a)(function(e){var t=10-c-l;console.log(t);for(var n=t;n<l+t;n++)e[f][o][c+n].isShip=!0})))},n.onClick=function(e,t,a){console.log(e),console.log(a);var r=E(e),i=Object(s.a)(r,2),o=i[0],c=i[1],l=n.makeShot(o,c);a-1||t||(console.log("You pressed on the player's 1 field"),l("player1shots")),a-1&&!t&&(console.log("You pressed on the player's 2 field"),l("player2shots"))},n.makeShot=function(e,t){return function(a){n.setState(Object(d.a)(function(n){n[a][e][t].isShot=!0}))}},n.endTurnMemo=function(){n.endTurn()},n.onClickMemo=function(e,t,a){n.onClick(e,t,a)},n.canDropShipMemo=function(e,t,a){return n.canDropShip(e,t,a)},n.placeShipMemo=function(e,t,a){n.placeShip(e,t,a)},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.generateCellsData()}},{key:"render",value:function(){var e=this.state,t=e.isYourTurn,n=e.player1ships,a=e.player1shots,i=e.player2ships,o=e.player2shots;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"game"},r.a.createElement(x,{label:"Player 1",endturn:this.endTurnMemo,shipsData:t?n:i,shotsData:t?a:o,onCellClick:this.onClickMemo,canDropShip:this.canDropShipMemo,placeShip:this.placeShipMemo}),r.a.createElement("div",{style:{border:"3px solid black",width:"250px",height:"150px"}},r.a.createElement("h4",null,"Place your ships"),N,Y,B,M),r.a.createElement(U,null)))}}]),t}(a.PureComponent);var J=function(){return r.a.createElement(c.b,{backend:l.a},r.a.createElement("div",{className:"App"},r.a.createElement(z,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,1,2]]]);
//# sourceMappingURL=main.e2cc0fd3.chunk.js.map